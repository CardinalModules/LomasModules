
static const float env_exponential_8_e[257] = {0.000000f,0.030777f,0.060608f,0.089521f,0.117544f,0.144705f,0.171030f,0.196545f,0.221276f,0.245245f,0.268477f,0.290995f,0.312819f,0.333972f,0.354474f,0.374346f,0.393606f,0.412273f,0.430366f,0.447903f,0.464899f,0.481373f,0.497341f,0.512816f,0.527816f,0.542354f,0.556445f,0.570103f,0.583340f,0.596170f,0.608605f,0.620658f,0.632339f,0.643662f,0.654636f,0.665272f,0.675581f,0.685573f,0.695258f,0.704644f,0.713742f,0.722560f,0.731107f,0.739390f,0.747419f,0.755201f,0.762743f,0.770053f,0.777139f,0.784006f,0.790662f,0.797114f,0.803366f,0.809427f,0.815301f,0.820994f,0.826512f,0.831860f,0.837044f,0.842068f,0.846938f,0.851658f,0.856233f,0.860667f,0.864964f,0.869129f,0.873166f,0.877079f,0.880872f,0.884548f,0.888110f,0.891564f,0.894911f,0.898154f,0.901299f,0.904346f,0.907300f,0.910162f,0.912937f,0.915626f,0.918233f,0.920759f,0.923208f,0.925581f,0.927881f,0.930111f,0.932272f,0.934366f,0.936396f,0.938364f,0.940271f,0.942119f,0.943911f,0.945647f,0.947330f,0.948961f,0.950542f,0.952074f,0.953559f,0.954999f,0.956394f,0.957746f,0.959057f,0.960327f,0.961559f,0.962752f,0.963909f,0.965030f,0.966116f,0.967169f,0.968190f,0.969179f,0.970138f,0.971068f,0.971969f,0.972842f,0.973688f,0.974508f,0.975303f,0.976074f,0.976820f,0.977544f,0.978246f,0.978926f,0.979585f,0.980223f,0.980843f,0.981443f,0.982024f,0.982588f,0.983134f,0.983664f,0.984177f,0.984675f,0.985157f,0.985624f,0.986077f,0.986516f,0.986942f,0.987354f,0.987754f,0.988141f,0.988517f,0.988881f,0.989233f,0.989575f,0.989907f,0.990228f,0.990539f,0.990841f,0.991133f,0.991417f,0.991692f,0.991958f,0.992216f,0.992466f,0.992708f,0.992943f,0.993171f,0.993392f,0.993606f,0.993813f,0.994014f,0.994209f,0.994398f,0.994581f,0.994758f,0.994930f,0.995097f,0.995258f,0.995415f,0.995567f,0.995714f,0.995856f,0.995994f,0.996128f,0.996258f,0.996384f,0.996506f,0.996624f,0.996738f,0.996849f,0.996957f,0.997061f,0.997162f,0.997260f,0.997355f,0.997447f,0.997536f,0.997623f,0.997707f,0.997788f,0.997867f,0.997943f,0.998017f,0.998089f,0.998158f,0.998225f,0.998291f,0.998354f,0.998415f,0.998475f,0.998532f,0.998588f,0.998642f,0.998694f,0.998745f,0.998795f,0.998842f,0.998889f,0.998933f,0.998977f,0.999019f,0.999060f,0.999099f,0.999138f,0.999175f,0.999211f,0.999246f,0.999280f,0.999313f,0.999344f,0.999375f,0.999405f,0.999434f,0.999462f,0.999489f,0.999516f,0.999541f,0.999566f,0.999590f,0.999613f,0.999636f,0.999658f,0.999679f,0.999699f,0.999719f,0.999739f,0.999757f,0.999775f,0.999793f,0.999810f,0.999826f,0.999842f,0.999858f,0.999873f,0.999888f,0.999902f,0.999915f,0.999929f,0.999941f,0.999954f,0.999966f,0.999978f,0.999989f,1.000000f,1.000000f};
// Adapted from lut envelope
// Decays from prev_level_ to 0 in 100.f*sampletime (100ms)
struct Antipop
{
    float phase_ = 0;
    float star_level_;
    float prev_level_;

    void trigger() {
        star_level_ = prev_level_;
        phase_ = 0;
    }

    float process(float sampleTime, float in) {
        prev_level_ = in;

        if (phase_ >= 1.0f) 
            return 0;
        
        phase_ += 25.0f * sampleTime;

        float position = interpolateLinear(env_exponential_8_e, phase_ * 255);

        return star_level_ + (0 - star_level_) * position;
    }
};